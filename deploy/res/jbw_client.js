function jbw_makeRequest(e){$.ajax({url:"api",type:"POST",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){jbw_processMsgs(e)}})}function jbw_start(){WebFont.load({google:{families:["Roboto Condensed"]}}),workSpace.tail=$(".jbw_workpane")[0],banner.tail=$(".banner")[0],objHandles[0]=workSpace,objHandles[1]=banner,jbw_resizeWorkpane(),$(window).resize(jbw_resizeWorkpane),jbw_makeRequest([{action:"start_session"}])}function jbw_resizeWorkpane(){$(".jbw_workpane").height(window.innerHeight-$(".jbw_workpane").offset().top)}function jbw_endSession(){window.close()}function getObject(e){return objHandles[e]?objHandles[e]:objHandles[1]}function jbw_processMsgs(e){console.log(JSON.stringify(e));try{for(var t=0;t<e.length;t++)"builder"==e[t].mode&&jbw_widget(e[t].content,getObject(e[t].parent))}catch(n){}jbw_resizeWorkpane()}function jbw_widget(e,t){var n={};t&&(e.parent=t),n=jbw_widgetize[e.type](e),t&&$(t.tail).append(e.head),widget_table[e.handle]=e;try{for(var a=0;a<e.children.length;a++)jbw_widget(e.children[a],e)}catch(i){}n&&n()}function jbw_panel(e){return e.head=$(document.createElement("div")),e.head.attr("title",e.title),e.head.css("width",e.width),e.head.css("height",e.height),e.head.css("x",e.x),e.head.css("y",e.y),e.tail=e.head,function(){e.head.dialog({minHeight:e.height,minWidth:e.width,resizable:!!e.resizable}).parent().draggable({containment:e.parent.tail})}}function jbw_form(e){return e.head=$(document.createElement("form")),e.tail=e.head,null}function jbw_button(e){return e.head=$(document.createElement("input")),e.head.attr("type","button"),e.head.attr("value",e.title),e.head.css("position","absolute"),null!==e.top&&e.head.css("top",e.top),null!==e.left&&e.head.css("left",e.left),null!==e.bottom&&e.head.css("bottom",e.bottom),null!==e.right&&e.head.css("right",e.right),e.head.on("click",function(){jbw_handleAction[e.action]()}),e.tail=e.head,null}function jbw_textbox(e){return e.head=$(document.createElement("input")),e.head.attr("type","textbox"),e.tail=e.head,null}function jbw_menuBar(e){return e.head=document.createElement("div"),$($(".banner")[0]).append(e.head),$(e.head).addClass("jbw_menubar"),e.tail=e.head,function(){$(document).on("click",function(e){$(e.target).closest(".jbw_menu").length||$(e.target).closest(".jbw_menuentry_active").length||($(".jbw_menu").hide(),$(".jbw_menuentry_active").addClass("jbw_menuentry"),$(".jbw_menuentry").removeClass("jbw_menuentry_active"))})}}function jbw_menuHeading(e){var t;return e.head=document.createElement("a"),$(e.head).attr("href","#"),t=document.createElement("div"),$(t).addClass("jbw_menuentry"),$(t).text(e.title),$(e.head).append(t),e.tail=document.createElement("div"),$(e.tail).addClass("jbw_menu"),function(){$(document.body).append(e.tail),$(e.tail).position({my:"left top",at:"left bottom",of:t}),$(e.tail).hide(),$(e.tail).addClass("jbw_menu_"+$(t).text().trim().replace(/ /g,"_")),$(t).on("click",function(e){var t=".jbw_menu_"+$(e.target).text().trim().replace(/ /g,"_"),n=!$(t).is(":visible");$(".jbw_menu").hide(),$(".jbw_menuentry_active").addClass("jbw_menuentry"),$(".jbw_menuentry").removeClass("jbw_menuentry_active"),n&&($(e.target).closest("div").removeClass("jbw_menuentry"),$(e.target).addClass("jbw_menuentry_active"),$(t).show())})}}function jbw_menuEntry(e){e.head=document.createElement("a"),$(e.head).attr("href","#"),e.tail=document.createElement("div"),$(e.tail).addClass("jbw_menuitem"),$(e.head).append(e.tail),$(e.tail).text(e.title)}function jbw_installMenu(){$("ul.jbw_menubar").each(function(){var e=document.createElement("div"),t=document.createElement("div");$(e).insertBefore(this),$(e).addClass("jbw_menubar"),$(t).addClass("jbw_menuver"),$(this).hide(),$(this).children("li").each(function(){var t=document.createElement("div");$(t).addClass("jbw_menu");var n=document.createElement("a");$(n).attr("href","#");var a=document.createElement("div");$(a).addClass("jbw_menuentry"),$(a).text(this.childNodes[0].nodeValue),$(n).append(a),$(e).append(n),$(this).children("ul").each(function(){$(this).children("li").each(function(){var e=document.createElement("a");$(e).attr("href","#");var n=document.createElement("div");$(n).addClass("jbw_menuitem"),$(e).append(n),$(t).append(e),$(n).append(this.childNodes[0].nodeValue)})}),$(document.body).append(t),$(t).position({my:"left top",at:"left bottom",of:a}),$(t).hide(),$(t).addClass("jbw_menu_"+$(a).text().trim().replace(/ /g,"_")),$(a).on("click",function(e){var t=".jbw_menu_"+$(e.target).text().trim().replace(/ /g,"_"),n=!$(t).is(":visible");$(".jbw_menu").hide(),$(".jbw_menuentry_active").addClass("jbw_menuentry"),$(".jbw_menuentry").removeClass("jbw_menuentry_active"),n&&($(e.target).closest("div").removeClass("jbw_menuentry"),$(e.target).addClass("jbw_menuentry_active"),$(t).show())})}),$(e).append(t),$(t).css("width","100%"),$(t).css("text-align","right"),$(t).text($jbw_gVersion)})}var $jbw_gVersion="v1.00.34",jbw_widgetize={panel:jbw_panel,form:jbw_form,menuBar:jbw_menuBar,menuHeading:jbw_menuHeading,menuEntry:jbw_menuEntry,textbox:jbw_textbox,button:jbw_button},jbw_handleAction={endsession:jbw_endSession},widget_table={},workSpace={},banner={},objHandles=[];